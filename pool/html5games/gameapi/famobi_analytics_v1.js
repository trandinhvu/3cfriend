!function(E,e){var t={stats:{},events:[],currentScreen:"",pageTitle:"",trackStats:function(E,e,n){return new Promise((function(r,S){var T={},a={};"string"==typeof E&&(a[E]=e);if(!function(){for(var e in a){if(!("string"==typeof E&&E.length&&E.length<=42&&E.match(/^[a-z\_0-9]+$/)))return!1}return!0}())return S("trackStats(): invalid params "+JSON.stringify(E,e)),!1;var i=function(E,e){if("string"==typeof E&&E.length)return E in t.stats&&null==e?delete t.stats[E]:void 0!==e&&e&&(t.stats[E]=e),!0;throw"trackStats(): key is not a string or an Object";return!1};if(E&&"object"==typeof E){for(var L in E)i(L,e=E[L]);T=E}else i(E,e),T[E]=e;famobi.hasOwnProperty("adapters")&&famobi.adapters.run("analytics","trackStats",E,e,n),r(T)}))},getStats:function(){return new Promise((function(E,e){E(t.stats)}))},trackEvent:function(E,e){return new Promise((function(n,r){if(void 0===t[E])return r("trackEvent(): unknown event '"+E+"'"),!1;if("object"!=typeof(e=e||{})&&null!==e)return r("trackEvent(): second parameter needs to be an object"),!1;if(!function(){var t={levelName:"",reason:["timeout","dead","wrong_answer","quit","draw"],levelScore:-0,liveScore:-0,totalScore:-0,bgmVolume:0,sfxVolume:0},n={EVENT_LEVELFAIL:["levelName","reason"],EVENT_LEVELRESTART:["levelName"],EVENT_LEVELSTART:["levelName"],EVENT_LEVELSUCCESS:["levelName"],EVENT_LEVELSCORE:["levelName","levelScore"],EVENT_LIVESCORE:["liveScore"],EVENT_TOTALSCORE:["totalScore"],EVENT_VOLUMECHANGE:["bgmVolume","sfxVolume"],EVENT_CUSTOM:[]};if(void 0!==n[E]&&0===Object.keys(e).length)return!1;if(void 0===n[E])return!0;for(var r=0,S="",T=null;r<n[E].length;r++){if("string"==typeof(T=t[S=n[E][r]])&&"string"!=typeof e[S])return!1;if("number"==typeof T&&"number"!=typeof e[S])return!1;if("object"==typeof T&&-1===T.indexOf(e[S]))return!1}return!0}())return r("trackEvent(): invalid params "+JSON.stringify(e));if(t.events.push({event:E,params:e}),famobi.hasOwnProperty("adapters")&&famobi.adapters.run("analytics","trackEvent",E,e),t.TRIGGER_SCORE.indexOf(E)>-1){if(!window.famobi.hasFeature("highscores"))return n(E,e);switch(E){case"EVENT_LEVELSCORE":famobi.submitHighscore(e.levelName,e.levelScore,!0);break;case"EVENT_TOTALSCORE":famobi.submitHighscore("TOTAL",e.totalScore,!0);break;default:}return Promise.all([]).then((function(){n(E,e)}))}return t.TRIGGER_LEVELSUCCESS.indexOf(E)>-1?Promise.all([window.famobi.showAd()]).then((function(){n(E,e)})):t.TRIGGER_LEVELFAIL.indexOf(E)>-1?"quit"==e.reason?n(E,e):Promise.all([window.famobi.showAd()]).then((function(){n(E,e)})):t.TRIGGER_LEVELSTART.indexOf(E)>-1?Promise.all([]).then((function(){n(E,e)})):t.TRIGGER_LIVESCORE.indexOf(E)>-1?(famobi.sendLiveScore(e.liveScore),n(E,e)):n(E,e)}))},getEvents:function(){return new Promise((function(E,e){E(t.events)}))},EVENT_CUSTOM:"EVENT_CUSTOM",EVENT_LEVELFAIL:"EVENT_LEVELFAIL",EVENT_LEVELRESTART:"EVENT_LEVELRESTART",EVENT_LEVELSTART:"EVENT_LEVELSTART",EVENT_LEVELSUCCESS:"EVENT_LEVELSUCCESS",EVENT_LIVESCORE:"EVENT_LIVESCORE",EVENT_LEVELSCORE:"EVENT_LEVELSCORE",EVENT_TOTALSCORE:"EVENT_TOTALSCORE",EVENT_TUTORIALCOMPLETED:"EVENT_TUTORIALCOMPLETED",EVENT_TUTORIALSKIPPED:"EVENT_TUTORIALSKIPPED",EVENT_VOLUMECHANGE:"EVENT_VOLUMECHANGE",EVENT_PAUSE:"EVENT_PAUSE",EVENT_RESUME:"EVENT_RESUME",trackScreen:function(E,e){return new Promise((function(n,r){return void 0===t[E]?(r("trackScreen(): unknown screen '"+E+"'"),!1):!e&&E.indexOf(["SCREEN_OTHER"])>-1?(r("trackScreen(): screen '"+E+"' requires param 'pageTitle'"),!1):e&&"string"!=typeof e?(r("trackScreen(): required param 'pageTitle' has to be a non-empty string"),!1):(t.currentScreen=E,t.pageTitle=e,famobi.hasOwnProperty("adapters")&&famobi.adapters.run("analytics","trackScreen",E,e),void n(E,e))}))},getScreen:function(){return t.currentScreen},getPageTitle:function(){return t.pageTitle},SCREEN_OTHER:"SCREEN_OTHER",SCREEN_BONUS:"SCREEN_BONUS",SCREEN_CHARACTER:"SCREEN_CHARACTER",SCREEN_CREDITS:"SCREEN_CREDITS",SCREEN_GAMERESULT:"SCREEN_GAMERESULT",SCREEN_HELP:"SCREEN_HELP",SCREEN_HOME:"SCREEN_HOME",SCREEN_LEVEL:"SCREEN_LEVEL",SCREEN_LEVELINTRO:"SCREEN_LEVELINTRO",SCREEN_LEVELLOADING:"SCREEN_LEVELLOADING",SCREEN_LEVELRESULT:"SCREEN_LEVELRESULT",SCREEN_LEVELSELECT:"SCREEN_LEVELSELECT",SCREEN_PAUSE:"SCREEN_PAUSE",SCREEN_SETTINGS:"SCREEN_SETTINGS",SCREEN_SHOP:"SCREEN_SHOP",SCREEN_SPLASH:"SCREEN_SPLASH",SCREEN_TUTORIAL:"SCREEN_TUTORIAL",TRIGGER_SCORE:["EVENT_LEVELSCORE","EVENT_TOTALSCORE"],TRIGGER_LIVESCORE:["EVENT_LIVESCORE"],TRIGGER_LEVELFAIL:["EVENT_LEVELFAIL"],TRIGGER_LEVELSUCCESS:["EVENT_LEVELSUCCESS"],TRIGGER_LEVELSTART:["EVENT_LEVELSTART","EVENT_LEVELRESTART"]};e.famobi_analytics=t}(0,window);